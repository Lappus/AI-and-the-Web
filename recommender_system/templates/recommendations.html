<!-- recommendations.html -->

{% extends "flask_user_layout.html" %}
{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='movies.css')}}"/>
{% endblock %}

{% block content %}
<div class="container">
    <h2>Your recommendations! </h2>
    {% if similar_users != None and wanted_genre==None %}
        <p>Your top movies:</p>
    {% elif similar_users != None and wanted_genre %}
        <p>Your top movies:</p>
        <p> Click a genre to filter for genre</p>
    {% elif similar_users == None and wanted_genre == None %}
        <p> You have rated less then 10 movies, so you get no personal recommandation, sorry! Here are up to 10 of the best rated movies instead:</p>
        <p> Click a genre to filter for genre</p>
    {% elif similar_users == None and wanted_genre %}
        <p> You have rated less then 10 movies, so you get no personal recommandation, sorry! Here are up to 10 of the best rated movies in the genre: <strong>{{wanted_genre}} </strong></p>
    {% endif %}

    <a href="{{ url_for('recommendations') }}" class="btn btn-primary"> Recalculate best matches </a>

    <div class="categories">
        <h3>Genres</h3>
        <form method="post" action="{{ url_for('recommendations') }}">
            <button type="submit" name="genre" value="Action" class="card-link btn btn-link">Action</button>
       
            <button type="submit" name="genre" value="Adventure" class="card-link btn btn-link">Adventure</button>
       
            <button type="submit" name="genre" value="Animation" class="card-link btn btn-link">Animation</button>
      
            <button type="submit" name="genre" value="Children's" class="card-link btn btn-link">Children's</button>
        
            <button type="submit" name="genre" value="Comedy" class="card-link btn btn-link">Comedy</button>
       
            <button type="submit" name="genre" value="Crime" class="card-link btn btn-link">Crime</button>
       
            <button type="submit" name="genre" value="Documentary" class="card-link btn btn-link">Documentary</button>
        
            <button type="submit" name="genre" value="Drama" class="card-link btn btn-link">Drama</button>
       
            <button type="submit" name="genre" value="Fantasy" class="card-link btn btn-link">Fantasy</button>
        
            <button type="submit" name="genre" value="Film-Noir" class="card-link btn btn-link">Film-Noir</button>
        
            <button type="submit" name="genre" value="Horror" class="card-link btn btn-link">Horror</button>
       
            <button type="submit" name="genre" value="Musical" class="card-link btn btn-link">Musical</button>
        
            <button type="submit" name="genre" value="Mystery" class="card-link btn btn-link">Mystery</button>
        
            <button type="submit" name="genre" value="Romance" class="card-link btn btn-link">Romance</button>
        
            <button type="submit" name="genre" value="Sci-Fi" class="card-link btn btn-link">Sci-Fi</button>
        
            <button type="submit" name="genre" value="Thriller" class="card-link btn btn-link">Thriller</button>
        
            <button type="submit" name="genre" value="War" class="card-link btn btn-link">War</button>
        
            <button type="submit" name="genre" value="Western" class="card-link btn btn-link">Western</button>
        </form>
    </div>

    {% for m in movies %}
        <div class="panel panel-default">
            <div class="panel-heading"><b>{{ m.title }}</b></div>
            <div class="panel-body">
                <p>
                    {% for g in m.genres %}
                        <span class="label label-default">{{ g.genre }}</span>
                    {% endfor %}
                </p>
                <p>
                    {% for movieId, tag in tags.items() %}
                        {% if movieId == m.id %}
                            {% for t in tag %}
                            <span class="label label-default">{{ t.tag }}</span>
                            {% endfor %}
                        {% endif %}
                    {% endfor %}
                </p>
                <p>
                    {% for movieId, link in links.items() %}
                        {% if movieId == m.id %}
                            {% for l in link %}
                            <a href="{{ 'https://www.imdb.com/title/tt0' + link.imdb_id|string }}" target="_blank"> <img src="../static/images/IMDb.png" alt="IMDb Image"></a>
                            <a href="{{ 'https://www.themoviedb.org/movie/' + link.tmdb_id|string }}" target="_blank"> <img src="../static/images/TMDB.png"></a>
                            {% endfor %}
                        {% endif %}
                    {% endfor %}
                </p>
                <p>
                    {% for movieId, rating in average_ratings.items() %}
                        {% if movieId == m.id %}
                            {% if rating is not none %}
                                <span style="color: black;"> Average rating: {{ rating.rating }}</span>
                                {% if rating.rating is not none and rating.rating < 1.5  %}
                                    <img src="../static/images/onestar.png" alt="1">
                                {% elif rating.rating >= 1.5 and rating.rating < 2.5 %}
                                    <img src="../static/images/twostars.png" alt="2">
                                {% elif rating.rating >= 2.5 and rating.rating < 3.5 %}
                                    <img src="../static/images/threestars.png" alt="3">
                                {% elif rating.rating >= 3.5 and rating.rating < 4.5 %}
                                    <img src="../static/images/fourstars.png" alt="4">
                                {% elif rating.rating >= 4.5 and rating.rating < 5.1 %}
                                    <img src="../static/images/fivestars.png" alt="5">
                                {% endif %}
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </p>    
            </div>
        </div>
    {% endfor %}
</div>

{% endblock %}
